<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

	<changeSet author="davijo" id="asset-01">
		<createTable tableName="asset">
			<column name="asset_id" type="BIGINT">
				<constraints primaryKey="true" primaryKeyName="asset_pk" />
			</column>
			<column name="asset_carr_id" type="BIGINT">
				<constraints nullable="false" />
			</column>
			<column name="asset_cfr" type="VARCHAR(12)" />
			<column name="asset_ircs" type="VARCHAR(8)" />
			<column name="asset_ircsindicator" type="VARCHAR(1)" />
			<column name="asset_mmsi" type="VARCHAR(9)" />
			<column name="asset_imo" type="VARCHAR(7)" />
			<column name="asset_yearofconstruction" type="VARCHAR(4)" />
            <column name="asset_placeofconstruction" type="VARCHAR(100)"/>
			<column name="asset_yearofcommissioning" type="VARCHAR(4)" />
			<column name="asset_monthofcommissioning" type="VARCHAR(2)" />
			<column name="asset_dayofcommissioning" type="VARCHAR(2)" />
			<column name="asset_hullmaterial" type="VARCHAR(100)" />
            <column name="asset_guid" type="VARCHAR(36)"/>
			<column name="asset_updattim" type="TIMESTAMP WITHOUT TIME ZONE" />
			<column name="asset_upuser" type="VARCHAR(60)" />
		</createTable>

        <createSequence sequenceName="asset_id_seq" minValue="100"/>
       
        <addForeignKeyConstraint baseColumnNames="asset_carr_id"
			baseTableName="asset" constraintName="asset_carr_fk" deferrable="false"
			initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"
			referencedColumnNames="carr_id" referencedTableName="carrier" />
       
		<rollback>
			<dropTable tableName="asset" cascadeConstraints="true"/>
		</rollback>
	</changeSet>
    
	<changeSet id="vessuk-03" author="davijo">
		<createIndex tableName="asset" indexName="asset_cfr_inx">
			<column name="asset_cfr"></column>
		</createIndex>
	</changeSet>
	<changeSet id="vessuk-04" author="davijo">
		<createIndex tableName="asset" indexName="asset_imo_inx">
			<column name="asset_imo"></column>
		</createIndex>
	</changeSet>
	<changeSet id="vessuk-05" author="davijo">
		<createIndex tableName="asset" indexName="asset_ircs_inx">
			<column name="asset_ircs"></column>
		</createIndex>
	</changeSet>
	<changeSet id="vessuk-06" author="davijo">
		<createIndex tableName="asset" indexName="asset_mmsi_inx">
			<column name="asset_mmsi"></column>
		</createIndex>
	</changeSet>
	<changeSet id="asset-cfr-unique" author="nhily">
		<addUniqueConstraint columnNames="asset_cfr" constraintName="asset_cfr_unique" deferrable="true" disabled="true" initiallyDeferred="true" tableName="asset"/>
		<rollback>
			<dropUniqueConstraint constraintName="asset_cfr_unique" tableName="asset"/>
		</rollback>
	</changeSet>
	<changeSet author="nhily" id="Add hibernate seq">
		<dropSequence sequenceName="asset_id_seq"/>
		<createSequence sequenceName="HIBERNATE_SEQUENCE" startValue="100"/>
		<rollback>
			<dropSequence sequenceName="HIBERNATE_SEQUENCE"/>
		</rollback>
	</changeSet>

	<changeSet author="thofan" id="Add iccat, uvi, gfcm to asset">
		<addColumn tableName="asset">
			<column name="asset_iccat" type="VARCHAR(50)" />
			<column name="asset_uvi" type="VARCHAR(50)" />
			<column name="asset_gfcm" type="VARCHAR(50)" />
		</addColumn>
	</changeSet>

	<changeSet author="matbul" id="Add ers and ais indicator">
		<addColumn tableName="asset">
			<column name="asset_ers_indicator" type="BOOLEAN" />
			<column name="asset_ais_indicator" type="BOOLEAN" />
			<column name="asset_vessel_type" type="VARCHAR(100)" />
			<column name="asset_vessel_date_of_entry" type="TIMESTAMP" />
			<column name="asset_registrationnumber" type="VARCHAR(14)" />
			<column name="asset_vmsindicator" type="BOOLEAN" />
            <column name="asset_main_fishing_gear_code" type="VARCHAR(100)" />
            <column name="asset_sub_fishing_gear_code" type="VARCHAR(100)" />
            <column name="asset_segment" type="VARCHAR(100)" />
            <column name="asset_country_of_import_or_export" type="VARCHAR(100)" />
            <column name="asset_type_of_export" type="VARCHAR(100)" />
            <column name="asset_public_aid" type="VARCHAR(100)" />
            <column name="asset_place_of_construction" type="VARCHAR(100)" />
		</addColumn>
	</changeSet>

</databaseChangeLog>

