<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd">

<changeSet id="filt_01" author="davijo">
    	<createTable tableName="filter">
    		<column autoIncrement="true" name="filt_id" type="BIGINT">
    			<constraints primaryKey="true" primaryKeyName="filt_pk"/>
    		</column>
    		<column name="flit_filtgrp_id" type="bigint"/>
    		<column name="filt_field" type="varchar(80)">
				<constraints nullable="false" />
			</column>
    		<column name="filt_value" type="varchar(100)">
				<constraints nullable="false" />
			</column>
    		<column name="flit_updattim" type="TIMESTAMP WITH TIME ZONE"/>
    		<column name="filt_upuser" type="varchar(60)"/>
    	</createTable>    
        <!--
    	<sql splitStatements="true">
			COMMENT ON TABLE filter IS 'Filter table.';
			COMMENT ON COLUMN filter.filt_id IS 'Synthetic key.';
			COMMENT ON COLUMN filter.flit_filtgrp_id IS 'FK filtergroup.';
			COMMENT ON COLUMN filter.filt_field IS 'Is the specific field the filter is on.';
			COMMENT ON COLUMN filter.filt_value IS 'Filter value.';
			COMMENT ON COLUMN filter.flit_updattim IS 'Last user changed row.';
			COMMENT ON COLUMN filter.filt_upuser IS 'Last user changed row.';
    	</sql>-->
    	<rollback>
    		<dropTable tableName="filter" cascadeConstraints="true"/>
    	</rollback>
    </changeSet>
    
    <changeSet author="davijo" id="filt_fk01">
		<addForeignKeyConstraint baseColumnNames="flit_filtgrp_id"
			baseTableName="filter" constraintName="filt_filtgrp_fk" deferrable="false"
			initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION"
			referencedColumnNames="filtgrp_id" referencedTableName="filtergroup" />
		<rollback>
		<!--
			<dropForeignKeyConstraints baseTableName="aircraft" constraintName = "air_carr_fk"/>
		-->
			<dropAllForeignKeyConstraints baseTableName="filter"/>
		</rollback>		
	</changeSet>

    <changeSet id="filt_02" author="davijo">
 	<renameColumn tableName="filter" oldColumnName="flit_filtgrp_id" newColumnName="filt_filtgrp_id"/>
 	<renameColumn tableName="filter" oldColumnName="flit_updattim" newColumnName="filt_updattim"/>
 	<rollback>
 		<renameColumn tableName="filter" oldColumnName="filt_filtgrp_id" newColumnName="flit_filtgrp_id"/>
 		<renameColumn tableName="filter" oldColumnName="filt_updattim" newColumnName="flit_updattim"/>
 	</rollback>
    </changeSet>
    
    <changeSet id="filt_02" author="davijo">
 	<renameColumn tableName="filter" oldColumnName="flit_filtgrp_id" newColumnName="filt_filtgrp_id"/>
 	<renameColumn tableName="filter" oldColumnName="flit_updattim" newColumnName="filt_updattim"/>
 	<rollback>
 		<renameColumn tableName="filter" oldColumnName="filt_filtgrp_id" newColumnName="flit_filtgrp_id"/>
 		<renameColumn tableName="filter" oldColumnName="filt_updattim" newColumnName="flit_updattim"/>
 	</rollback>
    </changeSet>
	<changeSet author="nhily" id="modify data type time without time zone">
		<modifyDataType
            columnName="flit_updattim"
            newDataType="TIMESTAMP WITHOUT TIME ZONE"
            tableName="filter"/>
	</changeSet>
</databaseChangeLog>
